[{"instruction": "What is the average US net price for each division?", "input": "", "output": "SELECT a.division, AVG(a.us_net_price) AS average_net_price FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division ORDER BY average_net_price DESC;"}, {"instruction": "Which region has the highest number of enrollments?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.region ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many students have used access code to enroll?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.has_used_access_code ILIKE 'Yes';"}, {"instruction": "How many active subscriptions are there by division?", "input": "", "output": "SELECT a.division, COUNT(a.unique_id) AS active_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status ILIKE 'Active Access' GROUP BY a.division ORDER BY active_subscriptions DESC;"}, {"instruction": "Which title has the maximum subscriptions in Physics discipline?", "input": "", "output": "SELECT a.project_title, COUNT(a.unique_id) AS total_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE 'Physics' GROUP BY a.project_title ORDER BY total_subscriptions DESC LIMIT 1;"}, {"instruction": "How many enrollments are there for each product status?", "input": "", "output": "SELECT a.product_status, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_status ORDER BY total_enrollments DESC;"}, {"instruction": "Can you tell me the total number of enrollments by instructor for the category named 'Mathematics'?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.category ILIKE 'Mathematics' GROUP BY a.instructor_name ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the distribution of paid and unpaid subscriptions across different divisions?", "input": "", "output": "SELECT a.division, a.paid_unpaid, COUNT(a.unique_id) AS count_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division, a.paid_unpaid ORDER BY a.division, count_subscriptions DESC;"}, {"instruction": "What are the top 5 disciplines by number of subscriptions in 'Northeast Region'?", "input": "", "output": "SELECT a.discipline, COUNT(a.unique_id) AS total_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region ILIKE 'Northeast Region' GROUP BY a.discipline ORDER BY total_subscriptions DESC LIMIT 5;"}, {"instruction": "Which courses have the highest enrollments for the author 'John Doe'?", "input": "", "output": "SELECT a.course_name, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.author_display_name ILIKE 'John Doe' GROUP BY a.course_name ORDER BY total_enrollments DESC;"}, {"instruction": "What is the average access duration in days for Physics courses?", "input": "", "output": "SELECT AVG(a.access_duration_derived) AS average_access_duration_days FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Physics%';"}, {"instruction": "How many students from 'XYZ University' have subscriptions with 'Active Access' status?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS active_students FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.school ILIKE '%XYZ University%' AND a.student_subscription_status = 'Active Access';"}, {"instruction": "How many courses started in the month of January, 2020? ", "input": "", "output": "SELECT COUNT(DISTINCT a.course) AS started_courses FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.month=1 AND a.year=2020;"}, {"instruction": "What is the total net price in US dollars for all subscriptions from 'XYZ University'? ", "input": "", "output": "SELECT SUM(a.us_net_price) AS total_us_net_price FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.school ILIKE '%XYZ University%';"}, {"instruction": "In which cities are we having the most enrollments of 'STEM' division?", "input": "", "output": "SELECT a.sfdc_city, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division = 'STEM' GROUP BY a.sfdc_city ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the count of unpaid subscriptions in the 'Southern Region'?", "input": "", "output": "SELECT COUNT(a.unique_id) AS unpaid_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region = 'Southern Region' AND LOWER(a.paid_unpaid) = 'unpaid';"}, {"instruction": "Who are the top 5 instructors with the most enrollments?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "Rank the courses by the count of paid subscribers.  ", "input": "", "output": "SELECT a.course, COUNT(DISTINCT a.unique_id) AS total_subscribers FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid' GROUP BY a.course ORDER BY total_subscribers DESC NULLS LAST;"}, {"instruction": "Provide the list of customers who requested a return in the year 2020.  ", "input": "", "output": "SELECT DISTINCT a.unique_id FROM temp_achive_lp_sapling_combined_activations_ai a WHERE EXTRACT(YEAR FROM a.return_request_date) = 2020;"}, {"instruction": "What is the estimated end date for the course with the longest access duration?", "input": "", "output": "SELECT a.course, MAX(a.subs_end_date) as estimated_end_date FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.access_duration_derived = (SELECT MAX(access_duration_derived) FROM temp_achive_lp_sapling_combined_activations_ai) GROUP BY a.course;"}, {"instruction": "What is the total number of enrolments in each discipline? ", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline;"}, {"instruction": "Which are the top 5 countries with respect to the number of enrollments?", "input": "", "output": "SELECT a.sfdc_country, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.sfdc_country ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "Can you break down the total enrollments on the basis of paid and unpaid subscriptions?", "input": "", "output": "SELECT a.paid_unpaid, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.paid_unpaid;"}, {"question": "Provide a breakdown of the total awards based on divisions.", "sql": "SELECT a.division, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division;", "valid": 1}, {"instruction": "Which title has the most enrollments?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.project_title ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Give me the breakdown of the total enrollments based on the different platforms.", "input": "", "output": "SELECT a.platform, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.platform;"}, {"instruction": "How many enrollments were acquired from each acquisition source?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source;"}, {"instruction": "Show me all the enrollments of the year 2020.", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020;"}, {"instruction": "What's the distribution of the total enrollments for High School versus College?", "input": "", "output": "SELECT a.hs_col, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.hs_col;"}, {"question": "Which are the top 5 books in terms of activations in the discipline of Mathematics?", "sql": "SQL\nSELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_activations \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.discipline = 'Mathematics' AND LOWER(a.paid_unpaid)='paid' \nGROUP BY a.project_title\nORDER BY total_activations DESC \nLIMIT 5;", "valid": 0}, {"question": "Can you show me the publisher-wise titles activation count last year?", "sql": "SQL\nSELECT a.product_publisher, a.project_title, COUNT(DISTINCT a.unique_id) AS total_activations \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = 2020 AND LOWER(a.paid_unpaid)='paid' \nGROUP BY a.product_publisher, a.project_title;", "valid": 0}, {"question": "What is the total activation rate for the discipline 'Physics' in the last 5 years?", "sql": "SQL\nSELECT a.year, COUNT(DISTINCT a.unique_id) AS total_activations \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.discipline = 'Physics' AND a.year BETWEEN 2016 AND 2021 AND LOWER(a.paid_unpaid)='paid' \nGROUP BY a.year\nORDER BY a.year;", "valid": 0}, {"question": "What is the total revenue generated from paid subscriptions in 2020 in US dollars?", "sql": "SQL\nSELECT SUM(a.us_consumer_price) AS total_revenue \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = 2020 AND LOWER(a.paid_unpaid)='paid';", "valid": 0}, {"question": "Can you give me the number of enrollments per month in 2020 for the discipline 'Computer Science'?", "sql": "SQL\nSELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = 2020 AND a.discipline = 'Computer Science'\nGROUP BY a.month;", "valid": 0}, {"instruction": "How many enrollments occurred in each month of 2020?", "input": "", "output": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = 2020\nGROUP BY a.month \nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Which discipline has the most paid enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.paid_unpaid) = 'paid'\nGROUP BY a.discipline \nORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "How many students have used an access code?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id)\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.has_used_access_code ILIKE 'Yes';"}, {"instruction": "What is the average price of a subscription across all disciplines?", "input": "", "output": "SELECT AVG(a.us_net_price)\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.paid_unpaid ILIKE 'paid';"}, {"instruction": "How many enrollments were purchased from the student store?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id)\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.purchased_from_studentstore ILIKE 'Yes-Purchase';"}, {"instruction": "Who are the top 5 authors with the most enrollments in the discipline of Mathematics?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.discipline ILIKE '%Mathematics%'\nGROUP BY a.author_display_name\nORDER BY total_enrollments DESC NULLS LAST\nLIMIT 5;"}, {"instruction": "Which product publisher has the most number of paid enrollments?", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.paid_unpaid) = 'paid'\nGROUP BY a.product_publisher \nORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "Which region has the most enrollments?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.region \nORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "What schools in the 'Northeast Region' have the most paid activations? ", "input": "", "output": "SELECT a.school, COUNT (DISTINCT a.unique_id) AS total_activations \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.region ILIKE '%Northeast Region%' AND LOWER(a.paid_unpaid) = 'paid' \nGROUP BY a.school \nORDER BY total_activations DESC NULLS LAST;"}, {"instruction": "Provide an overview of net US prices for all purchased subscriptions, broken down by discipline.", "input": "", "output": "SELECT a.discipline, SUM(a.us_net_price) AS total_net_price, AVG(a.us_net_price) AS average_net_price,\nMIN(a.us_net_price) AS min_net_price, MAX(a.us_net_price) AS max_net_price\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE LOWER(a.paid_unpaid) = 'paid'\nGROUP BY a.discipline\nORDER BY total_net_price DESC NULLS LAST;"}, {"instruction": "How many enrollments were done each month for the given discipline 'Physics'?", "input": "", "output": "SELECT a.month, a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Physics%' GROUP BY a.month, a.year ORDER BY a.year, a.month NULLS LAST;"}, {"instruction": "Which instructors had the most enrollments?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many enrollments are from the 'Northeast Region'?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region ILIKE '%Northeast Region%';"}, {"instruction": "Give the count of enrollments for each title.", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.project_title ORDER BY total_enrollments DESC NULLS last;"}, {"instruction": "How many enrollments are there for the provided 'paid' status?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid';"}, {"instruction": "What is the top discipline for each instructor by enrollments?", "input": "", "output": "WITH ranked_disciplines AS ( SELECT a.instructor_name, a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments, RANK() OVER (PARTITION BY a.instructor_name ORDER BY COUNT(DISTINCT a.unique_id) DESC) AS rank FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name, a.discipline ) SELECT instructor_name, discipline, total_enrollments FROM ranked_disciplines WHERE rank = 1 ORDER BY total_enrollments DESC;"}, {"instruction": "What is the total number of enrollments for the provided 'STEM' division?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division ILIKE '%STEM%';"}, {"instruction": "What's the count of 'Active Access' student subscriptions?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_active_subscription FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status ILIKE '%Active Access%';"}, {"instruction": "How many unique enrollments were started in the year 2020?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020;"}, {"instruction": "How many enrollments happened for each 'hs_col' category?", "input": "", "output": "SELECT a.hs_col, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.hs_col ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Which discipline has the highest number of enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "How many students have used access code?", "input": "", "output": "SELECT COUNT(a.unique_id) as total_students FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.has_used_access_code = 'Yes';"}, {"question": "How many students are enrolled in Mathematics discipline?", "sql": "SELECT COUNT(a.unique_id) as total_students FROM temp_achive_lp_sapling_combined_activations_ai a WHERE lower(a.discipline) = 'mathematics';", "valid": 1}, {"instruction": "What are the top 5 schools with the most enrollments?", "input": "", "output": "SELECT a.school, COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "How many students have active access status?", "input": "", "output": "SELECT COUNT(a.unique_id) as total_students FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status = 'Active Access';"}, {"instruction": "What is the most commonly published project title?", "input": "", "output": "SELECT a.project_title, COUNT(a.unique_id) as total_publications FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.project_title ORDER BY total_publications DESC NULLS LAST LIMIT 1;"}, {"instruction": "What are the total enrollments for each division?", "input": "", "output": "SELECT a.division, COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the total number of paid enrollments?", "input": "", "output": "SELECT COUNT(a.unique_id) as total_paid_students FROM temp_achive_lp_sapling_combined_activations_ai a WHERE lower(a.paid_unpaid) = 'paid';"}, {"instruction": "How many enrollments were started in the year 2020?", "input": "", "output": "SELECT COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020;"}, {"instruction": "What are the top 5 disciplines with the greatest number of enrollments? ", "input": "", "output": "SELECT a.discipline, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "How many students purchased from the student store in the year 2020?", "input": "", "output": "SELECT COUNT(a.unique_id) AS total_purchases FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore='Yes-Purchase' AND a.year=2020;"}, {"instruction": "Provide the total enrollment count for each school in California.", "input": "", "output": "SELECT a.school, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.sfdc_state='California' GROUP BY a.school ORDER BY total_enrollments DESC;"}, {"instruction": "Which instructors have the most enrollments?", "input": "", "output": "SELECT a.instructor_name, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name ORDER BY total_enrollments DESC;"}, {"instruction": "What is the total enrollment count for each category?", "input": "", "output": "SELECT a.category, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.category ORDER BY total_enrollments DESC;"}, {"instruction": "What is the total revenue earned from paid subscriptions in 2020?", "input": "", "output": "SELECT SUM(a.us_consumer_price) AS total_revenue FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.paid_unpaid='Paid' AND a.year=2020;"}, {"instruction": "What is the total enrollment count for each product publisher's titles?", "input": "", "output": "SELECT a.product_publisher, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher ORDER BY total_enrollments DESC;"}, {"instruction": "List all universities in the Northeast Region ordered by the number of enrollments.", "input": "", "output": "SELECT a.school, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region='Northeast Region' GROUP BY a.school ORDER BY total_enrollments DESC;"}, {"instruction": "How many users have access code but have not used it yet?", "input": "", "output": "SELECT COUNT(a.unique_id) AS total_users FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.has_used_access_code='No';"}, {"instruction": "What is the total enrollment count for each year?", "input": "", "output": "SELECT a.year, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year DESC;"}, {"instruction": "Can I know how many enrollments we've had in the Physics discipline?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Physics%';"}, {"instruction": "Can you tell me the top 5 territories with maximum enrollments?", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.territory ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "I want to know about the number of active and expired enrollments.", "input": "", "output": "SELECT a.student_subscription_status, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status IN ('Active Access','Expired Access') GROUP BY a.student_subscription_status;"}, {"instruction": "What are the top 5 disciplines where students have maximum enrolments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "Can you provide information on the number of paid and unpaid enrollments?", "input": "", "output": "SELECT a.paid_unpaid, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.paid_unpaid;"}, {"instruction": "Which authors have the highest number of enrollments?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "Can you list down the number of enrollments for each course?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name;"}, {"instruction": "I'd like to know how many enrollments have converted from trial to paid?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.conversion_date IS NOT NULL;"}, {"instruction": "Can you tell me which region had the highest number of enrollments last year?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = (SELECT max(b.year) - 1 FROM temp_achive_lp_sapling_combined_activations_ai b) GROUP BY a.region ORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "I am interested in knowing the number of enrollments for each publisher.", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher;"}, {"instruction": "Can you provide the distribution of enrollments by course for the discipline of Physics?", "input": "", "output": "SELECT a.course_name, COUNT(a.unique_id) AS number_of_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.discipline ILIKE '%Physics%'\nGROUP BY a.course_name\nORDER BY number_of_enrollments DESC;"}, {"instruction": "How many students have paid for subscriptions in the year 2020?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS number_of_paid_subscriptions\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.year = 2020 AND LOWER(a.paid_unpaid) = 'paid';"}, {"instruction": "Which project title had the most enrollments in the Humanities division?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS number_of_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.division ILIKE '%Humanities%'\nGROUP BY a.project_title\nORDER BY number_of_enrollments DESC\nLIMIT 1;"}, {"instruction": "What are the top 5 instructors with the most active access students?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS number_of_active_students\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.student_subscription_status = 'Active Access'\nGROUP BY a.instructor_name\nORDER BY number_of_active_students DESC\nLIMIT 5;"}, {"instruction": "Please provide the number of subscribers from each region in the year 2021.", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS number_of_subscribers\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.year = 2021\nGROUP BY a.region\nORDER BY number_of_subscribers DESC;"}, {"instruction": "Can you list the courses with most enrollments, sorted by the course name?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS number_of_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.course_name\nORDER BY a.course_name;"}, {"instruction": "How many subscriptions were created each month in 2021?", "input": "", "output": "SELECT a.month, COUNT (DISTINCT a.unique_id) AS total_subscriptions\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.year = 2021\nGROUP BY a.month\nORDER BY a.month;"}, {"instruction": "How many subscriptions have been purchased from the student store?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS number_of_purchases\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.purchased_from_studentstore ILIKE '%Yes-Purchase%';"}, {"instruction": "List the most common acquisition source for enrollments?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.acquisition_source\nORDER BY total_enrollments DESC\nLIMIT 1;"}, {"instruction": "What is the average US net price for all subscriptions?", "input": "", "output": "SELECT AVG(a.us_net_price) AS average_us_net_price\nFROM temp_achive_lp_sapling_combined_activations_ai a;"}, {"instruction": "Which are the top 5 projects enrolled in the year 2022? ", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2022 GROUP BY a.project_title ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "How many enrollments were started in the month of January in the year 2022?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.month = 1 AND a.year = 2022;"}, {"instruction": "Can you provide a list of enrollments purchased from the student store in the year 2021?", "input": "", "output": "SELECT a.unique_id, a.project_title FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 AND a.purchased_from_studentstore ILIKE 'Yes-Purchase';"}, {"instruction": "How many enrollments used an access code in the year 2022?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2022 AND a.has_used_access_code ILIKE 'Yes';"}, {"instruction": "Please provide the list of enrollments whose access has expired for the discipline Biology.", "input": "", "output": "SELECT a.unique_id, a.project_title FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Biology%' AND a.student_subscription_status ILIKE 'Expired Access';"}, {"instruction": "How many active enrollments are there for the author John Doe in the year 2022? ", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_active_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.author_display_name ILIKE 'John%Doe%' AND a.student_subscription_status ILIKE 'Active Access' AND a.year = 2022;"}, {"instruction": "Can you provide the list of projects with the highest enrollments which have paid subscriptions?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.paid_unpaid ILIKE 'Paid' GROUP BY a.project_title ORDER BY total_enrollments DESC NULLS LAST LIMIT 10;"}, {"instruction": "Can you find out the top 5 publishers based on enrollments for the year 2021? ", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.product_publisher ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "How many enrollments were started in the Rocky Mountain region from the Humanities division in the year 2022? ", "input": "", "output": "SELECT COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2022 AND a.region ILIKE '%Rocky Mountain Region%' AND a.division ILIKE '%Humanities%';"}, {"instruction": "Which schools have the greatest number of enrollments for the Biology discipline in California in 2021?", "input": "", "output": "SELECT a.school, COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Biology%' AND a.year = 2021 AND a.sfdc_state ILIKE '%California%' GROUP BY a.school ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "Can you tell me how many enrollments were there for each discipline?", "input": "", "output": "SELECT a.discipline, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC;"}, {"instruction": "Which school has the highest number of enrollments?", "input": "", "output": "SELECT a.school, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Which course had the most enrollments in the year 2021?", "input": "", "output": "SELECT a.course_name, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "What is the total number of active subscription status by each region?", "input": "", "output": "SELECT a.region, COUNT(a.unique_id) AS total_active_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status = 'Active Access' GROUP BY a.region ORDER BY total_active_subscriptions DESC;"}, {"instruction": "Which publisher published the majority of the products?", "input": "", "output": "SELECT a.product_publisher, COUNT(a.unique_id) AS total_published FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher ORDER BY total_published DESC LIMIT 1;"}, {"instruction": "Can you list how many enrollments are from each source?", "input": "", "output": "SELECT a.acquisition_source, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source ORDER BY total_enrollments DESC;"}, {"instruction": "How many enrollments used access code?", "input": "", "output": "SELECT COUNT(a.unique_id) AS total_used_access_codes FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.has_used_access_code = 'Yes';"}, {"instruction": "How many enrollments were there from each country?", "input": "", "output": "SELECT a.sfdc_country, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.sfdc_country ORDER BY total_enrollments DESC;"}, {"instruction": "Can you tell me the total number of enrollments for each month in the year 2020? ", "input": "", "output": "SELECT a.month, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.month ORDER BY total_enrollments DESC;"}, {"instruction": "How many enrollments are there for high school and how many for college?", "input": "", "output": "SELECT a.hs_col,COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.hs_col in ('High School', 'College') GROUP BY a.hs_col;"}, {"instruction": "How many enrollments were started in the year 2019?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019;"}, {"instruction": "Can you provide the list of unique project titles for the discipline Biology?", "input": "", "output": "SELECT DISTINCT a.project_title FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Biology%';"}, {"instruction": "I'm interested in knowing how many users purchased from the student store?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_purchases FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore ILIKE '%Yes-Purchase%';"}, {"instruction": "Can you show me the number of active users in each region?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_active_users FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status = 'Active Access' GROUP BY a.region ORDER BY total_active_users DESC NULLS LAST;"}, {"instruction": "List all enrollments in the STEM division.", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division = 'STEM';"}, {"instruction": "Can you show titles authored by 'Daniel Jones' in Mathematics discipline?", "input": "", "output": "SELECT a.project_title FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.author_display_name ILIKE '%Daniel%Jones%' AND a.discipline ILIKE '%Mathematics%';"}, {"instruction": "How many paid enrollments were there for each division?", "input": "", "output": "SELECT a.division, COUNT(DISTINCT a.unique_id) AS total_paid_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.paid_unpaid = 'Paid' GROUP BY a.division ORDER BY total_paid_enrollments DESC NULLS LAST;"}, {"instruction": "Can you provide the list of schools for which region is 'Southern Region'?", "input": "", "output": "SELECT DISTINCT a.school FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region = 'Southern Region';"}, {"instruction": "Show me the total number of enrollments for each course in the year 2020?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.course_name ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What are the total number of high school and college enrollments?", "input": "", "output": "SELECT a.hs_col, COUNT (DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.hs_col IN ('High School', 'College') GROUP BY a.hs_col ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many titles are enrolled per year?", "input": "", "output": "SELECT a.year, COUNT (DISTINCT a.project_title) AS total_titles_enrolled FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year DESC;"}, {"instruction": "Can you provide a list of project titles and their copyrights year?", "input": "", "output": "SELECT DISTINCT a.project_title, a.copyright_year FROM temp_achive_lp_sapling_combined_activations_ai a ORDER BY a.copyright_year DESC;"}, {"instruction": "Could you show the top 5 regions with the most enrollments?", "input": "", "output": "SELECT a.region, COUNT (a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.region ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "What is the number of enrollments per discipline?", "input": "", "output": "SELECT a.discipline, COUNT (a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC;"}, {"instruction": "In which month do we usually have the maximum enrollments?", "input": "", "output": "SELECT a.month, COUNT (a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.month ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "How many titles are purchased from Studentstore each year?", "input": "", "output": "SELECT a.year, COUNT(a.project_title) AS total_titles_bought FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore='Yes-Purchase' GROUP BY a.year ORDER BY a.year DESC;"}, {"question": "What are the top 5 schools with most enrollments?", "sql": "SELECT a.school, COUNT (a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_enrollments DESC LIMIT 5;", "valid": 1}, {"instruction": "Which publishers have the most number of enrollments for their titles?", "input": "", "output": "SELECT a.product_publisher, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher ORDER BY total_enrollments DESC;"}, {"instruction": "How many paid and unpaid enrollments are there?", "input": "", "output": "SELECT a.paid_unpaid, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.paid_unpaid;"}, {"question": "Which author has the most enrollments in the Physics discipline?", "sql": "SQL\nSELECT a.author_display_name, COUNT(DISTINCT a.unique_id) as total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.discipline ILIKE 'Physics' \nGROUP BY a.author_display_name \nORDER BY total_enrollments DESC NULLS LAST;", "valid": 0}, {"question": "Give a distribution of our account enrollments by region.", "sql": "SQL\nSELECT a.region, COUNT(DISTINCT a.unique_id) as total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.region \nORDER BY total_enrollments DESC NULLS LAST;", "valid": 0}, {"question": "What is the most common discipline in Southern Region?", "sql": "SQL\nSELECT a.discipline, COUNT (DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.region) = 'southern region' \nGROUP BY a.discipline \nORDER BY total_enrollments DESC NULLS LAST;", "valid": 0}, {"question": "How many enrollments are there per category?", "sql": "SQL\nSELECT a.category, COUNT (DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.category \nORDER BY total_enrollments DESC NULLS LAST;", "valid": 0}, {"question": "What are the top 5 countries with the most enrollments?", "sql": "SQL\nSELECT a.sfdc_country, COUNT (DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.sfdc_country \nORDER BY total_enrollments DESC NULLS LAST LIMIT 5;", "valid": 0}, {"instruction": "How many enrollments were started each year?", "input": "", "output": "SELECT a.year, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year;"}, {"instruction": "In each year, what was the total cost of all subscriptions in US dollars?", "input": "", "output": "SELECT a.year, SUM(a.us_consumer_price) AS total_cost FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year;"}, {"instruction": "Can you give me the monthly enrollment totals for a specific year, say 2020?", "input": "", "output": "SELECT a.month, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.month ORDER BY a.month;"}, {"instruction": "How many enrollments were made from each acquisition source?", "input": "", "output": "SELECT a.acquisition_source, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source ORDER BY total_enrollments DESC;"}, {"instruction": "Can you tell me the total number of enrollments in each division?", "input": "", "output": "SELECT a.division, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division ORDER BY total_enrollments DESC;"}, {"instruction": "What were the enrollment counts from each region?", "input": "", "output": "SELECT a.region, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.region ORDER BY total_enrollments DESC;"}, {"instruction": "Could you tell me the number of paid and unpaid enrollments?", "input": "", "output": "SELECT a.paid_unpaid, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.paid_unpaid ORDER BY total_enrollments DESC;"}, {"instruction": "I want to know the count of enrollments by course name.", "input": "", "output": "SELECT a.course_name, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_enrollments DESC;"}, {"instruction": "Can you tell me the number of enrollments by each school?", "input": "", "output": "SELECT a.school, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_enrollments DESC;"}, {"instruction": "How many enrollments were started each month in the year 2020?", "input": "", "output": "SELECT a.month, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.month ORDER BY a.month;"}, {"instruction": "How many activations were made in each year?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY total_activations DESC;"}, {"instruction": "Can you break down the activations according to publisher? ", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher ORDER BY total_activations DESC;"}, {"instruction": "What is the breakdown of activations across disciplines? ", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_activations DESC;"}, {"instruction": "What is the breakdown of activations by country? ", "input": "", "output": "SELECT a.sfdc_country, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.sfdc_country ORDER BY total_activations DESC;"}, {"instruction": "Can you show the activations for courses taught by professor John Doe? ", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.instructor_name ILIKE '%John%Doe%' GROUP BY a.course_name;"}, {"instruction": "How many paid enrollments are there in each discipline? ", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid' GROUP BY a.discipline;"}, {"instruction": "Show me the activations of each product in 2020. ", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.project_title;"}, {"instruction": "Can you provide the total activations broken down by month and year for Biology discipline? ", "input": "", "output": "SELECT a.year, a.month, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Biology%' GROUP BY a.year, a.month ORDER BY a.year, a.month;"}, {"instruction": "Which school has the highest number of activations?", "input": "", "output": "SELECT a.school, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_activations DESC LIMIT 1;"}, {"instruction": "Which course has the maximum number of activations?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_activations DESC LIMIT 1;"}, {"instruction": "Can you give me the number of enrollments per year?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the breakdown of student subscription status?", "input": "", "output": "SELECT a.student_subscription_status, COUNT(DISTINCT a.unique_id) AS count_of_status FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.student_subscription_status ORDER BY count_of_status DESC NULLS LAST;"}, {"instruction": "Which publisher has the highest number of enrollments?", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Which course has the most enrollments?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Could you show me the top 5 authors with the most enrollments? ", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "What is the total US net revenue for all enrollments?", "input": "", "output": "SELECT SUM(a.us_net_price) AS total_us_net_revenue FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.paid_unpaid ILIKE 'paid';"}, {"instruction": "What are the top 3 territories based on the number of enrollments? ", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.territory ORDER BY total_enrollments DESC NULLS LAST LIMIT 3;"}, {"instruction": "What is the distribution of enrollments in terms of paid and unpaid? ", "input": "", "output": "SELECT a.paid_unpaid, COUNT(DISTINCT a.unique_id) AS count_of_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.paid_unpaid ORDER BY count_of_enrollments DESC NULLS LAST;"}, {"instruction": "Which discipline has the most number of enrollments? ", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Show me the top 10 most enrolled courses in Physics discipline. ", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE 'Physics' GROUP BY a.course_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 10;"}, {"instruction": "What is the total net price and total list price in US dollars for paid subscriptions for each year?", "input": "", "output": "SELECT a.year, SUM(a.us_net_price) AS total_net_price, SUM(a.us_list_price) AS total_list_price FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid' GROUP BY a.year ORDER BY a.year NULLS LAST;"}, {"instruction": "Can you give me the count of unique enrollments per discipline for each year?", "input": "", "output": "SELECT a.year, a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year, a.discipline ORDER BY a.year, total_enrollments DESC NULLS LAST;"}, {"instruction": "Could you tell me the total duration of access for each unique course each year?", "input": "", "output": "SELECT a.year, a.course, SUM(a.access_duration_derived) AS total_duration FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year, a.course ORDER BY a.year, total_duration DESC NULLS LAST;"}, {"instruction": "How many subscriptions were purchased from the student store and how many were due to inclusive access each year?", "input": "", "output": "SELECT a.year, COUNT(a.unique_id) FILTER ( WHERE a.purchased_from_studentstore ILIKE 'Yes-Purchase' ) AS purchased_from_store, COUNT(a.unique_id) FILTER ( WHERE a.inclusive_access ILIKE 'Yes' ) AS via_inclusive_access FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year NULLS LAST;"}, {"instruction": "Which were the top 5 disciplines with the most enrollments each year? ", "input": "", "output": "WITH ranked_disciplines AS (SELECT a.year, a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments, RANK() OVER (PARTITION BY a.year ORDER BY COUNT(DISTINCT a.unique_id) DESC) AS rank FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year, a.discipline ) SELECT year, discipline, total_enrollments FROM ranked_disciplines WHERE rank <= 5 ORDER BY year, rank ;"}, {"instruction": "Can you show me the number of enrollments by month for the Physics discipline? ", "input": "", "output": "SELECT a.month, a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Physics%' GROUP BY a.month, a.year ORDER BY a.year, a.month NULLS LAST;"}, {"instruction": "Please provide a count of all active versus expired access for each year. ", "input": "", "output": "SELECT a.year, COUNT(a.unique_id) FILTER ( WHERE a.student_subscription_status ILIKE 'Active Access' ) AS active_access, COUNT(a.unique_id) FILTER ( WHERE a.student_subscription_status ILIKE 'Expired Access' ) AS expired_access FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year NULLS LAST;"}, {"instruction": "What are the top 10 courses with the most enrollments in the year 2020?", "input": "", "output": "SELECT a.course, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.course ORDER BY total_enrollments DESC NULLS LAST LIMIT 10;"}, {"instruction": "Can you fetch the instructors who have more than 1000 enrollments for their courses over the years?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name HAVING COUNT(DISTINCT a.unique_id) > 1000;"}, {"instruction": "Could you show me the top 5 project titles for the Humanities division based on enrollments?", "input": "", "output": "WITH ranked_projects AS (SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments, RANK() OVER (ORDER BY COUNT(DISTINCT a.unique_id) DESC) AS rank FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division ILIKE '%Humanities%' GROUP BY a.project_title ) SELECT project_title, total_enrollments FROM ranked_projects WHERE rank <= 5 ORDER BY rank;"}, {"instruction": "What are the top 5 projects by enrollments where the enrollment was started in 2021?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.project_title ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "Can you provide me a list of all active access users from the Southern Region?", "input": "", "output": "SELECT a.unique_id FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region LIKE '%Southern Region%' AND a.student_subscription_status LIKE 'Active Access';"}, {"instruction": "What is the average net price for Canadian subscriptions on the 'STEM' division?", "input": "", "output": "SELECT AVG(a.can_net_price) AS avg_can_net_price FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division LIKE '%STEM%';"}, {"instruction": "Could you tell me the number of enrollees from each territory in 2020?", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.territory;"}, {"instruction": "How many unique projects are there in the Physics discipline?", "input": "", "output": "SELECT COUNT(DISTINCT a.project_title) AS num_projects FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline LIKE '%Physics%';"}, {"instruction": "I'd like to know how many enrollments were started on each platform in 2021.", "input": "", "output": "SELECT a.platform, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.platform;"}, {"instruction": "Which instructor had the highest enrollments in 2019?", "input": "", "output": "WITH instructor_enrollments AS ( SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019 GROUP BY a.instructor_name ) SELECT instructor_name, total_enrollments FROM instructor_enrollments ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Can you show me the number of enrollments for each school in the Central Region?", "input": "", "output": "SELECT a.school, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region LIKE '%Central Region%' GROUP BY a.school;"}, {"instruction": "What were the top 3 sources of user acquisitions for enrollments in 2020?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.acquisition_source ORDER BY total_enrollments DESC LIMIT 3;"}, {"instruction": "What is the total net price for US subscriptions in the Mathematics discipline in 2021?", "input": "", "output": "SELECT SUM(a.us_net_price) AS total_us_net_price FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline LIKE '%Mathematics%' AND a.year = 2021;"}, {"instruction": "How many unique enrollees were acquired through various acquisition sources in year 2020?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollees FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.acquisition_source;"}, {"instruction": "Which are the top 5 universities with the highest enrollments in STEM discipline in year 2019? ", "input": "", "output": "SELECT a.sfdc_account_name, COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019 AND a.division ILIKE '%STEM%' GROUP BY a.sfdc_account_name ORDER BY total_enrollment DESC LIMIT 5;"}, {"instruction": "Which instructors had the highest number of enrollments in 2020 and taught in the Humanities division?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 AND LOWER(a.division)='humanities' GROUP BY a.instructor_name ORDER BY total_enrollments DESC;"}, {"instruction": "How many enrollments occurred each month in 2019 for courses in the \"Physics\" discipline?", "input": "", "output": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019 AND LOWER(a.discipline) = 'physics' GROUP BY a.month ORDER BY a.month;"}, {"instruction": "What is the total enrollment count for each product publisher in 2020?", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.product_publisher;"}, {"instruction": "Which categories have the most enrollments across all years?", "input": "", "output": "SELECT a.category, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.category ORDER BY total_enrollments DESC;"}, {"instruction": "Which students in New York state had the most enrollments in 2018?", "input": "", "output": "SELECT a.sfdc_account_name, COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2018 AND LOWER(a.sfdc_state) = 'new york' GROUP BY a.sfdc_account_name ORDER BY total_enrollment DESC;"}, {"instruction": "What is the total count of paid enrollments per month in 2020?", "input": "", "output": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_paid_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 AND LOWER(a.paid_unpaid) = 'paid' GROUP BY a.month ORDER BY a.month;"}, {"instruction": "Which course has the highest enrollment for the year 2019?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019 GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "How many enrollments had active access status from each acquisition source in 2020?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS active_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 AND LOWER(a.student_subscription_status) = 'active access' GROUP BY a.acquisition_source;"}, {"instruction": "What are the top 5 disciplines with the highest number of enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "How many enrollments do we have in each region?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.region ORDER BY total_enrollments DESC;"}, {"instruction": "Which instructor taught the most enrollments?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "What are the top 10 most popular courses in terms of enrollments?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 10;"}, {"instruction": "How many enrollments came through \"Inclusive Access\"?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.inclusive_access) = 'yes';"}, {"instruction": "What are the most common acquisition sources for our enrollments?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source ORDER BY total_enrollments DESC;"}, {"instruction": "In which year did we have the highest number of enrollments?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Which authors' titles have the most enrollments?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC;"}, {"instruction": "Which school has the most enrollments?", "input": "", "output": "SELECT a.school, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "What is the distribution of enrollments based on product status?", "input": "", "output": "SELECT a.product_status, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_status ORDER BY total_enrollments DESC;"}, {"instruction": "Could you please provide the list of titles purchased from the student store?", "input": "", "output": "SELECT a.project_title, COUNT(a.project_title)\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE LOWER(a.purchased_from_studentstore) = 'yes-purchase'\nGROUP BY a.project_title\nORDER BY COUNT(a.project_title) DESC NULLS LAST;"}, {"instruction": "How many enrollments happened in a given year?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.year\nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Can you show me the top 5 authors with the most enrollments?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.author_display_name\nORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "How many enrollments were there per territory?", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.territory\nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What are the most commonly used platforms?", "input": "", "output": "SELECT a.platform, COUNT(a.platform) \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.platform \nORDER BY COUNT(a.platform) DESC NULLS LAST;"}, {"instruction": "What are the top 5 disciplines with the most enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.discipline\nORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "Can you show the distribution of enrollments by division?", "input": "", "output": "SELECT a.division, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.division\nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many active access and expired access records are there in the student's subscription status dataset?", "input": "", "output": "SELECT a.student_subscription_status, COUNT(*)\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE LOWER(a.student_subscription_status) IN ('active access', 'expired access')\nGROUP BY a.student_subscription_status;"}, {"instruction": "What are the top 10 cities with the most enrollments?", "input": "", "output": "SELECT a.sfdc_city, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.sfdc_city\nORDER BY total_enrollments DESC NULLS LAST LIMIT 10;"}, {"instruction": "How many paid enrollments were there in each year?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_paid_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE LOWER(a.paid_unpaid)='paid'\nGROUP BY a.year\nORDER BY total_paid_enrollments DESC NULLS LAST;"}, {"question": "What are the top 5 disciplines with the most enrollments?", "sql": "SQL\nSELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.paid_unpaid)='paid'\nGROUP BY a.discipline \nORDER BY total_enrollments DESC \nNULLS LAST \nLIMIT 5;", "valid": 0}, {"question": "Show enrollments by region, starting from the region with the highest number of enrollments?", "sql": "SQL\nSELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.region \nORDER BY total_enrollments DESC;", "valid": 0}, {"question": "How many people have purchased from the student store vs inclusive access?", "sql": "SQL\nSELECT a.purchased_from_studentstore, a.inclusive_access, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.purchased_from_studentstore, a.inclusive_access;", "valid": 0}, {"question": "Can you give me a list of all courses under Discipline 'Physics' and their respective enrollments?", "sql": "SQL\nSELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.discipline = 'Physics' \nGROUP BY a.course_name;", "valid": 0}, {"question": "Can you provide a list of all authors and the total number of enrollments for their courses?", "sql": "SQL\nSELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.author_display_name;", "valid": 0}, {"instruction": "How many enrollments are there per month in the year 2020? ", "input": "", "output": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.month ORDER BY a.month;"}, {"instruction": "Can you tell me the total active and expired subscriptions status?", "input": "", "output": "SELECT a.student_subscription_status, COUNT(a.unique_id) AS total_status FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status IN ('Active Access', 'Expired Access') GROUP BY a.student_subscription_status;"}, {"instruction": "What is the number of enrollments acquired via different acquisition sources?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source;"}, {"instruction": "How many enrollments belong to each division?", "input": "", "output": "SELECT a.division, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division;"}, {"instruction": "Can you give a breakdown of enrollments by the instructors?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name;"}, {"instruction": "What was the total amount of US consumer price paid for all enrollments in the year 2020?", "input": "", "output": "SELECT SUM(a.us_consumer_price) AS total_amount_paid FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020;"}, {"instruction": "How many paid and unpaid enrollments were there in 2019? ", "input": "", "output": "SELECT a.paid_unpaid, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019 GROUP BY a.paid_unpaid;"}, {"instruction": "How many enrollments for each course were there in the month of May 2021? ", "input": "", "output": "SELECT a.course_name, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 AND a.month = 5 GROUP BY a.course_name;"}, {"instruction": "How many enrollments were made from student stores and how many were inclusive access in 2018?", "input": "", "output": "SELECT a.purchased_from_studentstore, a.inclusive_access, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2018 GROUP BY a.purchased_from_studentstore, a.inclusive_access;"}, {"instruction": "What is the count of enrollments per product status?", "input": "", "output": "SELECT a.product_status, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_status;"}, {"instruction": "Can you show me the number of enrollments for each discipline?", "input": "", "output": "SELECT a.discipline, COUNT (DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many instructors have enrollments in the Physics discipline?", "input": "", "output": "SELECT COUNT (DISTINCT a.instructor_name) AS total_instructors FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Physics%';"}, {"instruction": "What is the total US net price by year for paid enrollments?", "input": "", "output": "SELECT a.year, SUM(a.us_net_price) AS total_us_price FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid' GROUP BY a.year ORDER BY a.year NULLS LAST;"}, {"instruction": "How many enrollments used Inclusive Access and were acquired from Student Store?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.inclusive_access)='yes' AND LOWER(a.purchased_from_studentstore)='yes-purchase';"}, {"instruction": "List down the top 5 authors by enrollments.", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "How many enrollments originate from the 'Southern Region'?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.region)='southern region';"}, {"instruction": "Which instructors had the highest number of enrollments in Mathematics?", "input": "", "output": "SELECT a.instructor_name, COUNT (DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Mathematics%' GROUP BY a.instructor_name ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the average US list price by division for paid enrollments?", "input": "", "output": "SELECT a.division, AVG(a.us_list_price) AS average_price FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid' GROUP BY a.division ORDER BY average_price DESC NULLS LAST;"}, {"instruction": "List the enrollments by month for Chemistry for 2020.", "input": "", "output": "SELECT a.month, COUNT (DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Chemistry%' AND a.year=2020 GROUP BY a.month, a.year ORDER BY a.month NULLS LAST;"}, {"instruction": "What are the top 5 disciplines by enrollments in the Rocky Mountain Region?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region ILIKE '%Rocky%Mountain%Region%' GROUP BY a.discipline ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "What are the different divisions of enrollments in 2020?", "input": "", "output": "SELECT a.division, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.division;"}, {"instruction": "Find the 5 most popular courses in terms of enrollments.", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "From which countries do we have the maximum enrollments?", "input": "", "output": "SELECT a.sfdc_country, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.sfdc_country ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many enrollments do we have per division for STEM division? ", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division ILIKE '%STEM%';"}, {"instruction": "List all enrollments by month and year for the discipline Biology.", "input": "", "output": "SELECT a.year, a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Biology%' GROUP BY a.year, a.month ORDER BY a.year, a.month;"}, {"instruction": "Could you showcase the unique instructor_name having maximum number of enrollments.", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "Please provide the total number of paid subscriptions by each student in the Northeast Region.", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_paid_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region ILIKE '%Northeast Region%' AND LOWER(a.paid_unpaid) = 'paid';"}, {"instruction": "Will you list down the top 5 authors in terms of the number of enrollments they have?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "What is the total number of unique enrollments for all unpaid subscriptions in STEM discipline?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_unpaid_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division ILIKE '%STEM%' AND LOWER(a.paid_unpaid) = 'unpaid';"}, {"instruction": "I would like to know the total number of enrollments per discipline for the 'Physics' discipline.", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Physics%';"}, {"question": "How many students purchased from the student store each year?", "sql": "SELECT a.year, COUNT(a.unique_id) AS total_purchases FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore = 'Yes-Purchase' GROUP BY a.year ORDER BY a.year;", "valid": 1}, {"instruction": "How many students have activated their access code?", "input": "", "output": "SELECT COUNT(a.unique_id) AS total_activated FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.has_used_access_code = 'Yes';"}, {"instruction": "How many active and expired student subscriptions are there?", "input": "", "output": "SELECT a.student_subscription_status, COUNT(a.unique_id) AS total_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status IN ('Active Access', 'Expired Access') GROUP BY a.student_subscription_status;"}, {"instruction": "Can you provide a breakdown of enrollments by region?", "input": "", "output": "SELECT a.region, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.region ORDER BY total_enrollments DESC;"}, {"instruction": "How many subscriptions were accessed from different platforms?", "input": "", "output": "SELECT a.platform, COUNT(a.unique_id) AS total_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.platform ORDER BY total_subscriptions DESC;"}, {"instruction": "Can you list out the number of subscriptions from each country?", "input": "", "output": "SELECT a.sfdc_country, COUNT(a.unique_id) AS total_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.sfdc_country ORDER BY total_subscriptions DESC;"}, {"instruction": "How many students are enrolled in paid courses versus unpaid courses?", "input": "", "output": "SELECT a.paid_unpaid, COUNT(a.unique_id) AS total_students FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.paid_unpaid;"}, {"instruction": "How does the total enrollments each year trend for high school versus college?", "input": "", "output": "WITH hs_enrollments AS ( SELECT a.year, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.hs_col = 'High School' GROUP BY a.year ), col_enrollments AS ( SELECT a.year, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.hs_col = 'College' GROUP BY a.year ) SELECT hs.year, hs.total_enrollments AS hs_enrollments, col.total_enrollments AS college_enrollments FROM hs_enrollments hs JOIN col_enrollments col ON hs.year = col.year ORDER BY hs.year;"}, {"instruction": "Can you break down the total net subscription price in US dollars per discipline?", "input": "", "output": "SELECT a.discipline, SUM(a.us_net_price) AS total_net_price FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_net_price DESC;"}, {"instruction": "Can you show me the enrollment status for each college in the STEM division?", "input": "", "output": "SELECT a.hs_col, COUNT(DISTINCT a.unique_id) AS total_enrollments, a.student_subscription_status FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.division ILIKE '%STEM%' AND a.hs_col ILIKE '%College%' GROUP BY a.hs_col, a.student_subscription_status ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Which instructor has the highest number of enrollments in Biology?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Biology%' GROUP BY a.instructor_name ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "How many enrollments were done through the 'studentstore' in 2020?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore ILIKE '%Yes-Purchase%' AND a.year=2020;"}, {"instruction": "What are the active subscriptions in the Northeast Region?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS active_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region ILIKE '%Northeast Region%' AND a.student_subscription_status ILIKE '%Active Access%';"}, {"instruction": "What is the most popular title in Mathematics in terms of enrollments?", "input": "", "output": "SELECT a.project_title, COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Mathematics%' GROUP BY a.project_title ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Who is the author with the most enrollments?", "input": "", "output": "SELECT a.author_display_name, COUNT(a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Which school has the most paid enrollments?", "input": "", "output": "SELECT a.school, COUNT(a.unique_id) as total_paid_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid' GROUP BY a.school ORDER BY total_paid_enrollments DESC LIMIT 1;"}, {"instruction": "Can you provide annual enrollment growth for the Southern Region?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments, (COUNT(DISTINCT a.unique_id) - LAG (COUNT (DISTINCT a.unique_id), 1) OVER (ORDER BY a.year))/(LAG (COUNT (DISTINCT a.unique_id), 1) OVER (ORDER BY a.year)) AS growth_rate FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region ILIKE '%Southern Region%' GROUP BY a.year ORDER BY a.year NULLS LAST;"}, {"instruction": "How much revenue was generated by paid enrollments in Physics?", "input": "", "output": "SELECT SUM(a.us_consumer_price) as total_revenue FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid' AND a.discipline ILIKE '%Physics%';"}, {"instruction": "Name the top 5 titles by activations in the state of California?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) as total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.sfdc_state ILIKE '%California%' AND LOWER(a.paid_unpaid)='paid' GROUP BY a.project_title ORDER BY total_activations DESC LIMIT 5;"}, {"instruction": "Can you provide the total enrollments per school?", "input": "", "output": "SELECT a.school, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_enrollments DESC;"}, {"instruction": "What are the top 5 disciplines with the highest enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "I want to know the total number of enrollments per month for the year 2020.", "input": "", "output": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year=2020 GROUP BY a.month ORDER BY total_enrollments DESC;"}, {"instruction": "Can I know the yearly trend of enrollments for the course \"Physics\"?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.course_name ILIKE 'Physics' GROUP BY a.year ORDER BY a.year;"}, {"instruction": "How many enrollments do we have from each region?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.region ORDER BY total_enrollments DESC;"}, {"instruction": "Give me a count of enrollments per \"paid_unpaid\" status.", "input": "", "output": "SELECT a.paid_unpaid, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a  WHERE LOWER(a.paid_unpaid) IN ('paid', 'unpaid') GROUP BY a.paid_unpaid;"}, {"instruction": "Can you rank the top 10 enrollments from different territories?", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.territory ORDER BY total_enrollments DESC LIMIT 10;"}, {"instruction": "How many students have used the access code for enrollment?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.has_used_access_code ILIKE 'Yes';"}, {"instruction": "Can you tell me the overall enrollment count for projects hosted on the \"platforms\"?", "input": "", "output": "SELECT a.platform, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.platform ORDER BY total_enrollments DESC;"}, {"instruction": "Is there any way to find out the sum of 'US net price' for all the paid enrollments?", "input": "", "output": "SELECT SUM(a.us_net_price) AS total_net_price FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid';"}, {"instruction": "What is the average duration of access in months for each discipline?", "input": "", "output": "SELECT a.discipline, AVG(a.access_duration) as avg_access_duration \nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.discipline;"}, {"instruction": "How many enrollments were there per state in the country for the current year?", "input": "", "output": "SELECT a.sfdc_state, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE)\nGROUP BY a.sfdc_state;"}, {"instruction": "Which course had the highest number of enrollments in the current month?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.month = EXTRACT(MONTH FROM CURRENT_DATE)\nGROUP BY a.course_name\nORDER BY total_enrollments DESC\nLIMIT 1;"}, {"instruction": "Which author's title had the most enrollments last year?", "input": "", "output": "SELECT a.author_display_name, a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1\nGROUP BY a.author_display_name, a.project_title\nORDER BY total_enrollments DESC \nLIMIT 1;"}, {"instruction": "What was the total net price from paid subscriptions in the current year?", "input": "", "output": "SELECT SUM(a.us_net_price) as total_net_price \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.paid_unpaid) = 'paid' AND a.year = EXTRACT(YEAR FROM CURRENT_DATE);"}, {"instruction": "List all paid courses with their average access duration that were started in the current year.", "input": "", "output": "SELECT a.course_name, AVG(a.access_duration) as avg_access_duration \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND LOWER(a.paid_unpaid) = 'paid'\nGROUP BY a.course_name;"}, {"instruction": "List all cities with their total enrollments for the current year sorted in descending order.", "input": "", "output": "SELECT a.sfdc_city, COUNT(DISTINCT a.unique_id) as total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE)\nGROUP BY a.sfdc_city\nORDER BY total_enrollments DESC;"}, {"instruction": "List the number of enrollments by product publisher for the discipline Mathematics for the current year.", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.discipline ILIKE '%Mathematics%'\nGROUP BY a.product_publisher;"}, {"instruction": "List all the product statuses and their corresponding enrollments for the current year.", "input": "", "output": "SELECT a.product_status, COUNT(DISTINCT a.unique_id) as total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE)\nGROUP BY a.product_status;"}, {"instruction": "What is the most common source of user acquisition for each discipline?", "input": "", "output": "SELECT a.discipline, a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.discipline, a.acquisition_source\nORDER BY a.discipline, total_enrollments DESC;"}, {"instruction": "What are the top 10 disciplines with the most enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.discipline \nORDER BY total_enrollments DESC LIMIT 10;"}, {"instruction": "Who are the top 10 instructors with the highest enrollment students?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.instructor_name \nORDER BY total_enrollments DESC LIMIT 10;"}, {"instruction": "What are the total enrollments for the current year and for the same duration last year?", "input": "", "output": "WITH current_year_enrollment AS (\n SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments \n FROM temp_achive_lp_sapling_combined_activations_ai a \n WHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) \n AND a.subscription_created_date <= CURRENT_DATE \n GROUP BY a.year),\nlast_year_enrollment AS (\n SELECT a.year,  COUNT(DISTINCT a.unique_id) AS total_enrollments \n FROM temp_achive_lp_sapling_combined_activations_ai a \n WHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 \n AND a.subscription_created_date <= CURRENT_DATE - INTERVAL '1 year' \n GROUP BY a.year)\nSELECT * FROM current_year_enrollment \nUNION \nSELECT * from last_year_enrollment;"}, {"instruction": "What are the top 5 courses with the highest enrollments?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.course_name \nORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "Which schools have the maximum enrollments for Humanities division?", "input": "", "output": "SELECT a.school, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.division) = 'humanities' \nGROUP BY a.school \nORDER BY total_enrollments DESC;"}, {"instruction": "How many students bought their subscriptions from the student store?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_purchases \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.purchased_from_studentstore) = 'yes-purchase';"}, {"instruction": "What is the total revenue in US dollars for the current year?", "input": "", "output": "SELECT SUM(a.us_consumer_price) AS total_revenue_USD \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE);"}, {"instruction": "How many students have a status of \u201cActive Access\u201d in their subscriptions?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_active_access \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.student_subscription_status) = 'active access';"}, {"instruction": "What are the top 5 acquisition sources leading to maximum enrollments?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.acquisition_source \nORDER BY total_enrollments DESC LIMIT 5;"}, {"question": "How many unique enrollments were made each year? ", "sql": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year ASC;", "valid": 1}, {"instruction": "What is the total revenue generated from the US each year? ", "input": "", "output": "SELECT a.year, SUM(a.us_consumer_price) AS total_revenue FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid' GROUP BY a.year ORDER BY total_revenue DESC;"}, {"instruction": "What is the total number of enrollments per publisher?", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher ORDER BY total_enrollments DESC;"}, {"instruction": "Can you provide a list of enrollments by division?", "input": "", "output": "SELECT a.division, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division ORDER BY total_enrollments DESC;"}, {"instruction": "Which author's title saw the most enrollments?", "input": "", "output": "SELECT a.author_display_name, a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid' GROUP BY a.author_display_name, a.project_title ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Can you break down the enrollments by region?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid' GROUP BY a.region ORDER BY total_enrollments DESC;"}, {"instruction": "Can you show the activations by gender and paid status?", "input": "", "output": "SELECT a.gender, a.paid_unpaid, COUNT(DISTINCT a.unique_id) as total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.gender, a.paid_unpaid ORDER BY total_activations DESC;"}, {"instruction": "What are the top five disciplines by number of enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "How many enrollments were made in each category?", "input": "", "output": "SELECT a.category, COUNT(DISTINCT a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.category ORDER BY total_enrollments DESC;"}, {"instruction": "How many unique enrollments have been made by each instructor?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name ORDER BY total_enrollments DESC;"}, {"instruction": "What is the distribution of enrollments based on the discipline they belong to?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) as enrollment_count\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.discipline\nORDER BY enrollment_count DESC;"}, {"instruction": "How many enrollments were started for each month in the year 2020?", "input": "", "output": "SELECT a.year, a.month, COUNT(DISTINCT a.unique_id) as enrollment_count\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE a.year = 2020\nGROUP BY a.year, a.month\nORDER BY a.month;"}, {"instruction": "Which students have not used their access code yet?", "input": "", "output": "SELECT a.unique_id\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE LOWER(a.has_used_access_code) = 'no';"}, {"instruction": "How many active enrollments are there for each product category?", "input": "", "output": "SELECT a.category, COUNT(DISTINCT a.unique_id) as enrollment_count\nFROM temp_achive_lp_sapling_combined_activations_ai a\nWHERE LOWER(a.student_subscription_status) = 'active access'\nGROUP BY a.category\nORDER BY enrollment_count DESC;"}, {"instruction": "What is the average subscription price in US dollars?", "input": "", "output": "SELECT AVG(a.us_consumer_price) as average_price_us\nFROM temp_achive_lp_sapling_combined_activations_ai a;"}, {"instruction": "Which instructors have the most enrollments in their courses?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) as enrollment_count\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.instructor_name\nORDER BY enrollment_count DESC;"}, {"instruction": "What's the enrollment count for each publisher?", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) as enrollment_count\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.product_publisher\nORDER BY enrollment_count DESC;"}, {"instruction": "In which cities do we have the largest number of enrollments?", "input": "", "output": "SELECT a.sfdc_city, COUNT(DISTINCT a.unique_id) as enrollment_count\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.sfdc_city\nORDER BY enrollment_count DESC;"}, {"instruction": "How many subscriptions were created each year?", "input": "", "output": "SELECT date_part('year', a.subscription_created_date) as year, COUNT(DISTINCT a.unique_id) as count_subscriptions\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY year\nORDER BY year;"}, {"instruction": "What is the distribution of paid and unpaid enrollments?", "input": "", "output": "SELECT a.paid_unpaid, COUNT(DISTINCT a.unique_id) as count_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.paid_unpaid;"}, {"instruction": "What are the most popular disciplines by enrollment?", "input": "", "output": "SELECT a.discipline, COUNT (DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollment DESC NULLS LAST;"}, {"instruction": "Could you list the highest selling titles along with its author and price in US dollars?", "input": "", "output": "SELECT a.project_title, a.author_display_name, a.us_consumer_price FROM temp_achive_lp_sapling_combined_activations_ai a ORDER BY a.us_consumer_price DESC LIMIT 10;"}, {"instruction": "Could you provide the number of enrollments per year?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year ASC;"}, {"instruction": "What are the top 5 schools by enrollment count?", "input": "", "output": "SELECT a.school, COUNT (DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.school ORDER BY total_enrollment DESC NULLS LAST LIMIT 5;"}, {"instruction": "Provide the total enrollment numbers for disciplines, divided by whether they are in high school or college.", "input": "", "output": "SELECT a.discipline, a.hs_col,COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline, a.hs_col ORDER BY total_enrollment DESC NULLS LAST;"}, {"instruction": "List all courses in the 'Biology' discipline along with their enrollments.", "input": "", "output": "SELECT a.course, COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Biology%' GROUP BY a.course ORDER BY total_enrollment DESC NULLS LAST;"}, {"instruction": "Which territories have the most number of activations?", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid' GROUP BY a.territory ORDER BY total_activations DESC NULLS LAST;"}, {"instruction": "Can you provide a list of the courses by 'Mathematics' discipline and their starting dates?", "input": "", "output": "SELECT a.course, a.course_start_date FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE '%Mathematics%' ORDER BY a.course_start_date ASC NULLS LAST;"}, {"instruction": "Who are the authors with the highest number of activations?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid' GROUP BY a.author_display_name ORDER BY total_activations DESC NULLS LAST;"}, {"instruction": "How many activations were made from student store?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore ILIKE '%Yes-Purchase%';"}, {"instruction": "What is the total number of enrollments made by students in New York?", "input": "", "output": "SELECT a.sfdc_state, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.sfdc_state = 'New York' GROUP BY a.sfdc_state;"}, {"instruction": "How many students purchased from student store in 2020?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) as student_count FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore = 'Yes-Purchase' AND a.year = 2020;"}, {"instruction": "Provide the count of enrollments by discipline for each instructor.", "input": "", "output": "SELECT a.instructor_name, a.discipline, COUNT(DISTINCT a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.instructor_name, a.discipline ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Can you provide the breakdown of enrollments by division?", "input": "", "output": "SELECT a.division, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.division ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many enrollments were started by each month in 2019?", "input": "", "output": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019 GROUP BY a.month ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Which course has the highest number of enrollments?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "Provide the total number of active subscriptions by each territory.", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_active_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status = 'Active Access' GROUP BY a.territory ORDER BY total_active_subscriptions DESC NULLS LAST;"}, {"instruction": "What were the total enrollments for the Physics discipline in the Northeast Region?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) as total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline = 'Physics' and a.region = 'Northeast Region';"}, {"instruction": "How many students used access code for their subscriptions in 2019?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) as student_count FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.has_used_access_code = 'Yes' AND a.year = 2019;"}, {"instruction": "What is the total amount paid by the consumers in US dollars in 2018?", "input": "", "output": "SELECT SUM(a.us_consumer_price) as total_amount FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2018 AND a.paid_unpaid = 'Paid';"}, {"instruction": "What are the top purchased titles from the student store for the current year?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_purchases \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.purchased_from_studentstore = 'Yes-Purchase' \nGROUP BY a.project_title \nORDER BY total_purchases DESC NULLS LAST;"}, {"instruction": "Which discipline had the most enrollments in the second quarter of the current year?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.month BETWEEN 4 AND 6 \nGROUP BY a.discipline \nORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "How many unique users used access codes for their subscriptions in the last year?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS unique_users_used_codes \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND a.has_used_access_code='Yes';"}, {"instruction": "What were the top 5 publishing companies with the most actives users in the current month and year?", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS active_users \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.month = EXTRACT(MONTH FROM CURRENT_DATE) \nGROUP BY a.product_publisher \nORDER BY active_users DESC LIMIT 5;"}, {"instruction": "How many users have active access on the platform for the discipline Mathematics?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS active_users \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.discipline = 'Mathematics' AND a.student_subscription_status = 'Active Access';"}, {"instruction": "List the number of enrollees in each sales region for the current year.", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) \nGROUP BY a.region;"}, {"instruction": "How much revenue (US Consumer Price) was generated from paid activations in the STEM division last year?", "input": "", "output": "SELECT SUM(a.us_consumer_price) AS total_revenue \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND a.paid_unpaid = 'Paid' AND a.division = 'STEM';"}, {"instruction": "Which instructors had the most enrollments for their courses in the current year?", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) \nGROUP BY a.instructor_name \nORDER BY total_enrollments DESC;"}, {"instruction": "For the Northeast Region, list the total number of subscriptions that originated from each acquisition source in the last six months.", "input": "", "output": "SELECT a.acquisition_source, COUNT(a.unique_id) AS total_subscriptions \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.region = 'Northeast Region' AND a.subs_start_date>= (CURRENT_DATE - INTERVAL '6 months') \nGROUP BY a.acquisition_source;"}, {"instruction": "What are the top 5 cities with most College enrollments across all years?", "input": "", "output": "SELECT a.sfdc_city, COUNT(DISTINCT a.unique_id) AS college_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.hs_col = 'College' \nGROUP BY a.sfdc_city \nORDER BY college_enrollments DESC LIMIT 5;"}, {"instruction": "What are the top 5 disciplines by the number of enrollments for the current year?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) \nGROUP BY a.discipline \nORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "Can you provide the total enrollments for each publisher? ", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.product_publisher\nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the count of unique students enrolled in courses by each instructor? ", "input": "", "output": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.instructor_name\nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the total enrollment for \"Physics\" discipline courses in the year 2021?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.discipline ILIKE '%Physics%' AND a.year = 2021;"}, {"instruction": "For each sales region, what is the count of unique Paid enrollments?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_paid_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.paid_unpaid) = 'paid' \nGROUP BY a.region \nORDER BY total_paid_enrollments DESC NULLS LAST;"}, {"instruction": "List total enrollments by each author for the STEM division.", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.division ILIKE '%STEM%' \nGROUP BY a.author_display_name \nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Which are the top 5 projects by total enrollments?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.project_title \nORDER BY total_enrollments DESC NULLS LAST LIMIT 5;"}, {"instruction": "What's the profit center with the highest enrollment?", "input": "", "output": "SELECT a.profit_center_desc, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.profit_center_desc \nORDER BY total_enrollments DESC NULLS LAST LIMIT 1;"}, {"instruction": "Can you list total enrollments by each territory for paid subscriptions?", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE LOWER(a.paid_unpaid) = 'paid' \nGROUP BY a.territory \nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many unique enrollments are there for each product status?", "input": "", "output": "SELECT a.product_status, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.product_status \nORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Can you provide a list of the top 10 projects with the most enrolments? \n", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.project_title ORDER BY total_enrollments DESC LIMIT 10;"}, {"instruction": "How many enrolments have been made in the discipline of Mathematics?\n", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.discipline) = 'mathematics';"}, {"instruction": "Which titles did author Jessica Davis publish in the year 2020?\n", "input": "", "output": "SELECT a.project_title FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.author_display_name) = 'jessica davis' AND a.year = 2020;"}, {"instruction": "What is the total revenue from paid subscriptions hosted on the \"Achieve\" platform in the year 2021? \n", "input": "", "output": "SELECT SUM(a.us_consumer_price) AS total_revenue FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.platform = 'Achieve' AND a.year = 2021 AND LOWER(a.paid_unpaid)='paid';"}, {"instruction": "How many subscriptions were purchased from the Student Store?\n", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore = 'Yes-Purchase';"}, {"instruction": "List down the top 5 courses with the most enrollments in 2021?\n", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "How many enrollments were made in the \"Northeast Region\" in the year 2020?\n", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region = 'Northeast Region' AND a.year = 2020;"}, {"instruction": "Who are the top 5 authors with most activations?\n", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid) = 'paid' GROUP BY a.author_display_name ORDER BY total_activations DESC LIMIT 5;"}, {"instruction": "How many Active Access subscriptions have been made by students from the \"Pacific High School\" in the year 2020?\n", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 AND a.school = 'Pacific High School' AND a.student_subscription_status = 'Active Access';"}, {"instruction": "What are the top 3 territories in terms of enrollments for the discipline of Physics?\n", "input": "", "output": "SELECT a.territory, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.discipline) = 'physics' GROUP BY a.territory ORDER BY total_enrollments DESC LIMIT 3;"}, {"question": "Can you provide information on enrollment count per course for the year 2020?", "sql": "SQL\nSELECT a.course, COUNT(a.unique_id) AS enrollment_count \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = 2020 \nGROUP BY a.course \nORDER BY enrollment_count DESC;", "valid": 0}, {"question": "How many students purchased from Student Store in the year 2019?", "sql": "SQL\nSELECT COUNT(a.unique_id) \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.purchased_from_studentstore = 'Yes-Purchase' AND a.year = 2019;", "valid": 0}, {"question": "What is the total US consumer price for each product publisher?", "sql": "SQL\nSELECT a.product_publisher, SUM(a.us_consumer_price) AS total_us_consumer_price \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.product_publisher;", "valid": 0}, {"question": "How many enrollments with active access were there in each month of 2019?", "sql": "SQL\nSELECT a.month, COUNT(a.unique_id) AS active_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.student_subscription_status = 'Active Access' AND a.year = 2019 \nGROUP BY a.month \nORDER BY active_enrollments DESC;", "valid": 0}, {"question": "How many enrollments were there in each division in the city of Toronto?", "sql": "SQL\nSELECT a.division, COUNT(a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.sfdc_city = 'Toronto' \nGROUP BY a.division \nORDER BY total_enrollments DESC;", "valid": 0}, {"instruction": "What is the total net price in US dollars of subscriptions for each course?", "input": "", "output": "SELECT a.course_id, SUM(a.us_net_price) AS total_net_price FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_id ORDER BY total_net_price DESC;"}, {"question": "How many students started their enrollment in each month of 2021?", "sql": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.month ORDER BY total_enrollments DESC NULLS LAST;", "valid": 1}, {"instruction": "What's the average access duration, in days, per discipline?", "input": "", "output": "SELECT a.discipline, AVG(a.access_duration_derived) AS average_duration FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY average_duration DESC NULLS LAST;"}, {"instruction": "Which publishers have the most paid enrollments?", "input": "", "output": "SELECT a.product_publisher, COUNT (DISTINCT a.unique_id) AS total_paid_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.paid_unpaid='Paid' GROUP BY a.product_publisher ORDER BY total_paid_enrollments DESC NULLS LAST;"}, {"instruction": "For each state, how many students have an active access subscription?", "input": "", "output": "SELECT a.sfdc_state, COUNT (DISTINCT a.unique_id) AS active_access_students FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status='Active Access' GROUP BY a.sfdc_state ORDER BY active_access_students DESC NULLS LAST;"}, {"instruction": "How many titles are published each year by discipline and who are the authors?", "input": "", "output": "SELECT a.copyright_year, a.discipline, a.author_display_name, COUNT(DISTINCT a.project_title) as Total_Titles FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.copyright_year, a.discipline, a.author_display_name ORDER BY Total_Titles DESC NULLS LAST;"}, {"instruction": "What is the total number of returns requested per course in 2021?", "input": "", "output": "SELECT a.course_id, COUNT(DISTINCT a.return_request_date) AS total_returns FROM temp_achive_lp_sapling_combined_activations_ai a WHERE EXTRACT(YEAR FROM a.return_request_date) = 2021 GROUP BY a.course_id ORDER BY total_returns DESC NULLS LAST;"}, {"instruction": "What's the total consumer price paid, in Canadian dollars, by each student?", "input": "", "output": "SELECT a.unique_id, SUM(a.can_consumer_price) AS total_consumer_price FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.unique_id ORDER BY total_consumer_price DESC NULLS LAST;"}, {"instruction": "How many students have purchased from the student store per category?", "input": "", "output": "SELECT a.category, COUNT (DISTINCT a.unique_id) AS total_purchases_from_store FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore = 'Yes-Purchase' GROUP BY a.category ORDER BY total_purchases_from_store DESC NULLS LAST;"}, {"instruction": "Which are the top ten disciplines with the most enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC LIMIT 10;"}, {"instruction": "What is the total number of activations for each project title in 2020?", "input": "", "output": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 AND LOWER(a.paid_unpaid)='paid' GROUP BY a.project_title ORDER BY total_activations DESC;"}, {"instruction": "Which are the top five authors whose titles have the most enrollments, across all years?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "Count the number of paid versus unpaid enrollments for each discipline in 2020.", "input": "", "output": "SELECT a.discipline, a.paid_unpaid, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE year = 2020 GROUP BY a.discipline, a.paid_unpaid ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What is the average price paid by the consumer for this product in US dollars per discipline?", "input": "", "output": "SELECT a.discipline, AVG(a.us_consumer_price) FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline;"}, {"instruction": "How many enrollments were there per month in 2021?", "input": "", "output": "SELECT a.month, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.month ORDER BY total_enrollments DESC;"}, {"instruction": "Which schools have the most enrollments in Physics discipline?", "input": "", "output": "SELECT a.school, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE 'Physics' GROUP BY a.school ORDER BY total_enrollments DESC;"}, {"instruction": "What are the top five publishing platforms by enrollments?", "input": "", "output": "SELECT a.platform, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.platform ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "What is the total number of activations for each project title by division?", "input": "", "output": "SELECT a.division, a.project_title, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.paid_unpaid)='paid' GROUP BY a.division, a.project_title ORDER BY total_activations DESC;"}, {"instruction": "Which are the top three courses with the highest enrollments?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 3;"}, {"instruction": "Can you tell me how many enrollments there are per author?", "input": "", "output": "SELECT a.author_display_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "I'm interested in knowing the breakdown of enrollments by discipline. Can you provide that?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Could you provide the number of student subscriptions statuses? ", "input": "", "output": "SELECT a.student_subscription_status, COUNT(DISTINCT a.unique_id) AS total_student_subscription_statuses FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.student_subscription_status ORDER BY total_student_subscription_statuses DESC NULLS LAST;"}, {"instruction": "How many enrollments were from an inclusive access source?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.inclusive_access ILIKE 'Yes';"}, {"instruction": "Could you provide the amount of paid and unpaid enrollments?", "input": "", "output": "SELECT a.paid_unpaid, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.paid_unpaid ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many enrollments were made each year?", "input": "", "output": "SELECT a.year, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.year ORDER BY a.year NULLS LAST;"}, {"instruction": "What are the total enrollments by region?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.region ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Could you provide the number of enrollments by product status?", "input": "", "output": "SELECT a.product_status, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_status ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "How many enrollments were there per product publisher?", "input": "", "output": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.product_publisher ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "Could you provide the total enrollments by course name?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.course_name ORDER BY total_enrollments DESC NULLS LAST;"}, {"instruction": "What are the top 10 courses for the year 2022 based on enrollments?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2022 GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 10;"}, {"instruction": "Can you provide the information of activations of titles in the discipline of Mathematics?", "input": "", "output": "SELECT a.project_title, COUNT (DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.discipline) = 'mathematics' GROUP BY a.project_title ORDER BY total_activations DESC;"}, {"instruction": "How many active subscriptions are there in the platform?", "input": "", "output": "SELECT a.platform, COUNT(a.unique_id) AS active_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.student_subscription_status = 'Active Access' GROUP BY a.platform;"}, {"instruction": "What are the activations by author 'John Doe' in the Humanities division?", "input": "", "output": "SELECT a.project_title, COUNT (DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.author_display_name ILIKE '%John%Doe%' AND LOWER(a.division)='humanities' AND LOWER(a.paid_unpaid)='paid' GROUP BY a.project_title ORDER BY total_activations DESC;"}, {"instruction": "How many enrollments are from each country for the year 2023?", "input": "", "output": "SELECT a.sfdc_country, COUNT (DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2023 GROUP BY a.sfdc_country ORDER BY total_enrollments DESC;"}, {"instruction": "What are the most popular titles purchased from the student store?", "input": "", "output": "SELECT a.project_title, COUNT (DISTINCT a.unique_id) AS total_purchased FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.purchased_from_studentstore = 'Yes-Purchase' GROUP BY a.project_title ORDER BY total_purchased DESC;"}, {"instruction": "List all enrollments for schools in 'New York' state.", "input": "", "output": "SELECT a.school, COUNT (DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.sfdc_state ILIKE 'New York' GROUP BY a.school ORDER BY total_enrollment DESC;"}, {"instruction": "What are the top 5 courses in terms of enrollments for students with Inclusive Access?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.inclusive_access = 'Yes' GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "What is the total income from paid subscriptions in the USA in US dollars in 2021?", "input": "", "output": "SELECT SUM(a.us_consumer_price) AS total_income FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 AND a.sfdc_country = 'United States' AND a.paid_unpaid = 'Paid';"}, {"instruction": "How many activations were acquired via each acquisition source?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_activations FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source ORDER BY total_activations DESC;"}, {"instruction": "What are the average list prices in US and Canada?", "input": "", "output": "SELECT AVG(a.us_list_price) AS avg_us_list_price, AVG(a.can_list_price) AS avg_can_list_price FROM temp_achive_lp_sapling_combined_activations_ai a;"}, {"instruction": "How many enrollments were active in the year 2020?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020;"}, {"instruction": "How many courses were started in different regions in the year 2021?", "input": "", "output": "SELECT a.region, COUNT(DISTINCT a.course_id) AS total_courses FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.region;"}, {"instruction": "Who are the top 5 authors with highest enrollments?", "input": "", "output": "SELECT a.author_display_name, COUNT(a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.author_display_name ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "What is the most frequent acquisition source for the enrollments?", "input": "", "output": "SELECT a.acquisition_source, COUNT(*) AS frequency FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source ORDER BY frequency DESC LIMIT 1;"}, {"instruction": "How many enrollments acquired through 'Email' has used the access code?", "input": "", "output": "SELECT COUNT(*) FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.acquisition_source = 'Email' AND a.has_used_access_code = 'Yes';"}, {"instruction": "What is the overall enrollment growth from 2019 to 2020?", "input": "", "output": "WITH enrollment_2019 AS ( SELECT COUNT(DISTINCT a.unique_id) AS total_2019_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2019 ),\n     enrollment_2020 AS ( SELECT COUNT(DISTINCT a.unique_id) AS total_2020_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 )\nSELECT (e2020.total_2020_enrollments - e2019.total_2019_enrollments) * 100.0 / e2019.total_2019_enrollments AS growth_percentage FROM enrollment_2019 e2019, enrollment_2020 e2020;"}, {"instruction": "List the top 5 cities with the highest number of unique enrollments in 2021.", "input": "", "output": "SELECT a.sfdc_city, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 GROUP BY a.sfdc_city ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "Which course had the most number of unique enrollments in 2020?", "input": "", "output": "SELECT a.course_name, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2020 GROUP BY a.course_name ORDER BY total_enrollments DESC LIMIT 1;"}, {"instruction": "How many unique students subscribed to the 'Physics' discipline in the 'Northeast Region' in the year 2021?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline = 'Physics' AND a.region = 'Northeast Region' AND a.year = 2021;"}, {"instruction": "Can you list out the top 5 disciplines with the most enrollments?", "input": "", "output": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.discipline ORDER BY total_enrollments DESC LIMIT 5;"}, {"instruction": "Could you please provide the total enrollment count for the University of North Carolina?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollment FROM temp_achive_lp_sapling_combined_activations_ai a WHERE LOWER(a.school) LIKE '%university of north carolina%';"}, {"instruction": "How many enrollments were there in the discipline 'Physics' in the year 2020?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE 'Physics' AND a.year = 2020;"}, {"instruction": "What is the total income from paid enrollments for the year 2021 in US dollars? ", "input": "", "output": "SELECT SUM(a.us_consumer_price) AS total_income FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 AND LOWER(a.paid_unpaid)='paid';"}, {"instruction": "Can I get a list of names and emails of instructors who teach 'Biology'?", "input": "", "output": "SELECT DISTINCT a.instructor_name, a.instructor_email FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.discipline ILIKE 'Biology';"}, {"instruction": "How many enrollments were made from the student store in the year 2021?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.year = 2021 AND a.purchased_from_studentstore = 'Yes-Purchase';"}, {"instruction": "What are the top 3 acquisition sources for our users?", "input": "", "output": "SELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_users FROM temp_achive_lp_sapling_combined_activations_ai a GROUP BY a.acquisition_source ORDER BY total_users DESC LIMIT 3;"}, {"instruction": "How many students have used an access code for the course 'Physics 101'?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_students FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.course_name ILIKE 'Physics 101' AND a.has_used_access_code = 'Yes';"}, {"instruction": "What is the total number of active student subscriptions in the region 'Southern Region'?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_active_subscriptions FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.region ILIKE 'Southern Region' AND a.student_subscription_status = 'Active Access';"}, {"instruction": "How many enrollments for the product publisher 'McGraw-Hill Education' were there in 2021?", "input": "", "output": "SELECT COUNT(DISTINCT a.unique_id) AS total_enrollments FROM temp_achive_lp_sapling_combined_activations_ai a WHERE a.product_publisher ILIKE 'McGraw-Hill Education' AND a.year = 2021;"}, {"question": "How many students converted from trial to paid in the year 2020?", "sql": "SQL\nSELECT COUNT(DISTINCT a.unique_id) AS total_students \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE EXTRACT(YEAR FROM a.conversion_date) = 2020;", "valid": 0}, {"question": "What are the total enrollments broken down by the enrollments' status?", "sql": "SQL\nSELECT a.student_subscription_status, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.student_subscription_status \nORDER BY total_enrollments DESC;", "valid": 0}, {"question": "How many enrollments do each instructor have?", "sql": "SQL\nSELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments\nFROM temp_achive_lp_sapling_combined_activations_ai a\nGROUP BY a.instructor_name\nORDER BY total_enrollments DESC;", "valid": 0}, {"question": "How many subscription users were acquired through each acquisition source?", "sql": "SQL\nSELECT a.acquisition_source, COUNT(DISTINCT a.unique_id) AS total_users \nFROM temp_achive_lp_sapling_combined_activations_ai a \nGROUP BY a.acquisition_source \nORDER BY total_users DESC;", "valid": 0}, {"question": "Which project title has the most enrollments in the Northeast Region?", "sql": "SQL\nWITH project_enrollments AS (\n  SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_enrollments, \n    RANK() OVER(ORDER BY COUNT(DISTINCT a.unique_id) DESC) as rank\n  FROM temp_achive_lp_sapling_combined_activations_ai a \n  WHERE a.region ILIKE 'Northeast Region'\n  GROUP BY a.project_title\n) \nSELECT project_title, total_enrollments \nFROM project_enrollments \nWHERE rank = 1;", "valid": 0}]