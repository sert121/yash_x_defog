{"system_prompt": "You are an expert and thoughtful SQL analyst and understand data very well. \nYou have a two-step role: You need to come up with potential user questions that could be asked about the data. \nNow, based on the questions you have come up with, you need to write SQL queries that would help answer those questions.\n\nAlways follow these instructions for generating the user-question:\n1. Make sure that the questions are relevant to the data and are not ambiguous.\n2. Make sure that the questions are human-like.\n3. Make sure the question is not too confusing.\n\nAlways follow these instructions for generating the SQL query:\n1. Only use the table names and column names that are in the metadata schema. Do NOT use any other tables names or column names.\n2. Do NOT create a JOIN statement or query multiple tables if the question can be answered using only one table.\n3. When writing SELECT statements, always add the table alias as a prefix to the column name. For example, this SQL query is not valid: `SELECT a FROM table1 JOIN table2 ON table1.a = table2.a`. Instead, this query is correct: `SELECT table1.a FROM table1 JOIN table2 ON table1.a = table2.a`\n4. SELECT statements should include all columns that are in the ORDER BY statements. For example, if the ORDER BY statement is `ORDER BY column_name`, then the SELECT statement should include `column_name`\n5. Make sure that the GROUP BY statements do NOT contain an alias, and only contain original column names that exist in the schema.\n6. If creating GROUP BY statements, always include columns with `id` in the column name in the SELECT and GROUP BY statements to ensure uniqueness.\n7. When matching a string pattern, always do case insensitive matching unless a reference query states otherwise or unless the column might represent a categorical variable. You can chain multiple patterns using the OR operator. (e.g. LOWER(column_name) LIKE \"%stringtomatch1%\" OR LOWER(column_name) ILIKE \"%stringtomatch2%\")\n8. When a user asks for data by month, they are typically asking for data by both the month and year\n9. If the question cannot be answered given the database schema, always generate a query that says `SELECT 'Sorry, I could not answer that. Could you please rephrase your question?' AS answer;`. Do not give a closest approximation to the user's question. Do not use proxies for unavailable information.\n\nAs a reference, to generate a valid user question and corresponding SQL you can use the following examples:\n{examples}", "user_prompt": "You need to generate 10 instances of (user_question, sql_code). The database schema is represented in the following CSV string:\n```{table_metadata_ddl}```\nFollow the same format as the examples to produce the user question and SQL code. Separate each genrated pair with a separator #."}
[{"question": "What are the top purchased titles from the student store for the current year?", "sql": "SELECT a.project_title, COUNT(DISTINCT a.unique_id) AS total_purchases \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.purchased_from_studentstore = 'Yes-Purchase' \nGROUP BY a.project_title \nORDER BY total_purchases DESC NULLS LAST;", "valid": 1}]
[{"question": "Which discipline had the most enrollments in the second quarter of the current year?", "sql": "SELECT a.discipline, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.month BETWEEN 4 AND 6 \nGROUP BY a.discipline \nORDER BY total_enrollments DESC LIMIT 1;", "valid": 1}]
[{"question": "How many unique users used access codes for their subscriptions in the last year?", "sql": "SELECT COUNT(DISTINCT a.unique_id) AS unique_users_used_codes \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND a.has_used_access_code='Yes';", "valid": 1}]
[{"question": "What were the top 5 publishing companies with the most actives users in the current month and year?", "sql": "SELECT a.product_publisher, COUNT(DISTINCT a.unique_id) AS active_users \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) AND a.month = EXTRACT(MONTH FROM CURRENT_DATE) \nGROUP BY a.product_publisher \nORDER BY active_users DESC LIMIT 5;", "valid": 1}]
[{"question": "How many users have active access on the platform for the discipline Mathematics?", "sql": "SELECT COUNT(DISTINCT a.unique_id) AS active_users \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.discipline = 'Mathematics' AND a.student_subscription_status = 'Active Access';", "valid": 1}]
[{"question": "List the number of enrollees in each sales region for the current year.", "sql": "SELECT a.region, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) \nGROUP BY a.region;", "valid": 1}]
[{"question": "How much revenue (US Consumer Price) was generated from paid activations in the STEM division last year?", "sql": "SELECT SUM(a.us_consumer_price) AS total_revenue \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND a.paid_unpaid = 'Paid' AND a.division = 'STEM';", "valid": 1}]
[{"question": "Which instructors had the most enrollments for their courses in the current year?", "sql": "SELECT a.instructor_name, COUNT(DISTINCT a.unique_id) AS total_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.year = EXTRACT(YEAR FROM CURRENT_DATE) \nGROUP BY a.instructor_name \nORDER BY total_enrollments DESC;", "valid": 1}]
[{"question": "For the Northeast Region, list the total number of subscriptions that originated from each acquisition source in the last six months.", "sql": "SELECT a.acquisition_source, COUNT(a.unique_id) AS total_subscriptions \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.region = 'Northeast Region' AND a.subs_start_date>= (CURRENT_DATE - INTERVAL '6 months') \nGROUP BY a.acquisition_source;", "valid": 1}]
[{"question": "What are the top 5 cities with most College enrollments across all years?", "sql": "SELECT a.sfdc_city, COUNT(DISTINCT a.unique_id) AS college_enrollments \nFROM temp_achive_lp_sapling_combined_activations_ai a \nWHERE a.hs_col = 'College' \nGROUP BY a.sfdc_city \nORDER BY college_enrollments DESC LIMIT 5;", "valid": 1}]
